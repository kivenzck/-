# 专业课程设计2

## 一、目录

[toc]



## 二、目计方自反



## 三、需求分析

为了设计一个客户/服务器程序的同步与通信机制，我们需要首先进行需求分析，然后设计系统架构，接着实现关键功能，并最终通过HTML实现用户界面。以下是详细的需求分析和设计过程。

### 需求分析

#### 应用场景
- **电子交易系统**：用户可以查询股票信息和进行股票交易。
- **服务器端**：负责存储用户账户信息、股票信息和处理交易请求。
- **客户端**：提供用户界面，允许用户登录、查询股票信息和提交交易请求。

#### 功能需求
- **用户登录**：用户输入用户名和密码，系统验证后登录。
- **股票查询**：用户可以查询特定股票的当前价格和历史价格。
- **股票交易**：用户可以提交买入或卖出股票的请求。
- **服务器端处理**：服务器端处理股票查询和交易请求，更新股票信息和用户账户状态。

#### 性能需求
- **实时性**：股票信息和交易结果需要实时更新。
- **可靠性**：系统需要保证数据的一致性和完整性。
- **安全性**：用户数据和交易信息需要加密保护。

#### 用户界面需求
- **用户友好**：界面简洁直观，易于操作。
- **响应式**：界面需要适应不同设备的屏幕尺寸。

### 系统设计

#### 进程间同步与通信机制
- **进程间通信**：使用socket进行进程间通信。
- **同步机制**：使用互斥锁（mutex）和条件变量（condition variable）来同步进程间的操作。

#### 系统架构
- **客户端**：前端使用HTML/CSS/JavaScript实现用户界面，后端使用socket与服务器通信。
- **服务器端**：使用C++或Python等语言实现，负责处理客户端请求和管理数据。

### 实现过程

#### 服务器端实现
- **进程管理**：创建服务者进程监听客户端连接请求。
- **消息处理**：定义消息格式，处理查询和交易请求。
- **数据同步**：使用同步机制确保数据一致性。

#### 客户端实现
- **用户界面**：使用HTML/CSS/JavaScript实现用户登录、股票查询和交易界面。
- **通信逻辑**：使用JavaScript的`XMLHttpRequest`或`fetch` API与服务器通信。

#### HTML页面实现
- **登录页面**：实现用户登录表单，提交后跳转到`index.html`。
- **主页面**：展示股票信息和交易表单。

### 关键程序清单

- **服务器端**：`server.cpp`（C++）或`server.py`（Python）。
- **客户端**：`index.html`、`login.html`、`client.js`。

### 测试与调试
- **单元测试**：对服务器端的各个功能模块进行单元测试。
- **集成测试**：测试客户端与服务器端的通信和同步机制。
- **性能测试**：确保系统在高负载下仍能稳定运行。

### 总结与改进
- **总结**：回顾项目开发过程中的关键决策和遇到的问题。
- **改进**：根据测试结果和用户反馈，提出改进方案。

### HTML实现过程和代码

#### 登录页面（login.html）

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>登录</title>
</head>
<body>
    <form id="loginForm">
        <label for="username">用户名:</label>
        <input type="text" id="username" name="username" required>
        <label for="password">密码:</label>
        <input type="password" id="password" name="password" required>
        <button type="submit">登录</button>
    </form>
    <script src="login.js"></script>
</body>
</html>
```

#### 主页面（index.html）

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>股票交易系统</title>
</head>
<body>
    <h1>欢迎来到股票交易系统</h1>
    <!-- 股票查询和交易表单 -->
    <script src="index.js"></script>
</body>
</html>
```

#### JavaScript（login.js）

```javascript
document.getElementById('loginForm').addEventListener('submit', function(event) {
    event.preventDefault();
    var username = document.getElementById('username').value;
    var password = document.getElementById('password').value;
    // 发送登录请求到服务器
    // ...
});
```

#### JavaScript（index.js）

```javascript
// 初始化socket连接
// 发送股票查询请求
// 处理股票查询结果
// 发送交易请求
// 处理交易结果
```

请注意，上述代码仅为示例，实际开发中需要根据具体需求进行详细设计和实现。此外，还需要编写服务器端的代码来处理客户端的请求，并实现相应的同步和通信机制。



## 四、流程图

由于我无法直接创建图形图像，我将提供一个详细的流程图描述，您可以根据这个描述使用流程图软件（如Visio、Lucidchart、draw.io等）来绘制流程图。

### 电子交易系统流程图描述

#### 1. 用户登录
- 用户打开登录页面。
- 用户输入用户名和密码。
- 用户点击登录按钮。
- 客户端发送登录请求到服务器。
- 服务器验证用户信息。
- 服务器返回验证结果给客户端。
- 如果验证成功，跳转到主页面；如果失败，显示错误信息。

#### 2. 主页面
- 用户在主页面上进行操作。
- 用户可以查询股票信息或进行交易。
- 用户点击查询股票按钮。
- 客户端发送查询请求到服务器。
- 服务器处理查询请求并返回结果。
- 客户端显示查询结果。
- 用户点击交易按钮。
- 客户端发送交易请求到服务器。
- 服务器处理交易请求并更新数据。
- 服务器返回交易结果给客户端。
- 客户端显示交易结果。

#### 3. 服务器端处理
- 服务器监听客户端连接请求。
- 接收到连接请求后，建立连接。
- 接收客户端发送的请求。
- 根据请求类型（登录、查询、交易）进行处理。
- 处理完毕后，发送响应给客户端。
- 如果需要，更新数据库中的数据。

#### 4. 客户端与服务器通信
- 客户端使用socket与服务器建立连接。
- 客户端发送请求到服务器。
- 客户端接收服务器的响应。
- 客户端根据响应更新用户界面。

#### 5. 数据同步与安全
- 服务器端使用互斥锁和条件变量同步进程间操作。
- 服务器端使用加密技术保护用户数据和交易信息。

#### 6. 异常处理
- 客户端和服务器端都应有异常处理机制。
- 当发生异常时，记录错误信息并通知用户。

### 绘制流程图步骤
1. 使用流程图软件创建新文档。
2. 添加开始和结束符号。
3. 根据上述描述，添加决策/处理步骤。
4. 使用箭头连接各个步骤，表示流程方向。
5. 标注每个步骤的详细描述。
6. 为每个决策/处理步骤添加条件判断。
7. 确保流程图清晰、逻辑性强。

通过上述步骤，您可以绘制出一个清晰的电子交易系统流程图，展示用户登录、查询股票、进行交易等操作的流程。